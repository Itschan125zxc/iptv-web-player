<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IPTV Player</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.6.0/shaka-player.compiled.min.js"></script>
</head>
<body>

    <video id="video-player" width="800" height="450" controls autoplay></video>
    <button onclick="loadVideo('http://fl2.moveonjoy.com/ACC_NETWORK/index.m3u8')">Play HLS</button>
    <button onclick="loadVideo('https://qp-pldt-live-grp-02-prod.akamaized.net/out/u/tv5_hd.mpd')">Play DASH</button>

    <script>
        function loadVideo(sourceUrl) {
            const videoElement = document.getElementById("video-player");

            // Fix Mixed Content Issues with CORS Proxy
            if (sourceUrl.startsWith("http://")) {
                sourceUrl = `https://corsproxy.io/?${encodeURIComponent(sourceUrl)}`;
                console.warn("Using proxy:", sourceUrl);
            }

            // HLS (.m3u8) Handling
            if (sourceUrl.endsWith(".m3u8")) {
                if (Hls.isSupported()) {
                    const hls = new Hls();
                    hls.loadSource(sourceUrl);
                    hls.attachMedia(videoElement);
                    hls.on(Hls.Events.MANIFEST_PARSED, () => {
                        videoElement.play().catch(err => console.error("Autoplay prevented:", err));
                    });
                } else {
                    console.error("HLS not supported.");
                }
            }
            // DASH (.mpd) Handling
            else if (sourceUrl.endsWith(".mpd")) {
                if (shaka.Player.isBrowserSupported()) {
                    const player = new shaka.Player(videoElement);
                    player.load(sourceUrl).then(() => {
                        console.log("DASH video loaded successfully!");
                        videoElement.play().catch(err => console.error("Autoplay prevented:", err));
                    }).catch(err => {
                        console.error("Error loading DASH video:", err);
                    });
                } else {
                    console.error("Shaka Player is not supported.");
                }
            } else {
                console.error("Unsupported format:", sourceUrl);
            }
        }
    </script>

</body>
</html>
